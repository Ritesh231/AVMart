import{r as c,j as e}from"./index-DwftglYh.js";import{j as w,d as C}from"./index-BASg2LZ3.js";import{a as S,u as k,b as P}from"./productsApi--YTSQkNk.js";import{V as v}from"./index-BByxZPSn.js";import{S as V,D as I}from"./search-DPiFR_aJ.js";import{S as U,C as L}from"./sliders-horizontal-CyPAUmww.js";import"./iconBase-BklN5bFW.js";function F({isOpen:x,onClose:m,productData:n}){const[h,{isLoading:g}]=S(),[t,d]=c.useState({productName:"",subtext:"",description:"",keyFeatures:"",wholesaleAdvantage:"",brand:"",category:"",subcategory:"",categoryname:"",subcategoryname:"",status:"active",slug:"",primaryImage:null,variants:[]}),[u,p]=c.useState(null);c.useEffect(()=>{n&&(d({productName:n.name||"",subtext:n.subtext||"",description:n.description||"",keyFeatures:n.keyFeatures||"",wholesaleAdvantage:n.wholesaleAdvantage||"",brand:n.brand||"",category:n.category?._id||"",subcategory:n.subcategory?._id||"",categoryname:n.category?.name||"",subcategoryname:n.subcategory?.name||"",status:n.status||"active",primaryImage:null,variants:n.variants||[]}),p(n.displayImage||null))},[n]);const l=a=>{const{name:r,value:s,files:o}=a.target;if(r==="primaryImage"){const N=o[0];d({...t,primaryImage:N}),p(URL.createObjectURL(N))}else d({...t,[r]:s})},i=(a,r,s)=>{const o=[...t.variants];o[a][r]=s,d({...t,variants:o})},b=(a,r)=>{const s=[...t.variants];s[a].image=r,s[a].preview=URL.createObjectURL(r),d({...t,variants:s})},y=()=>{d({...t,variants:[...t.variants,{size:"",price:"",stock:"",sku:"",image:null}]})},j=a=>{const r=t.variants.filter((s,o)=>o!==a);d({...t,variants:r})},f=async()=>{try{const a=new FormData;a.append("productName",t.productName),a.append("subtext",t.subtext),a.append("description",t.description),a.append("keyFeatures",t.keyFeatures),a.append("wholesaleAdvantage",t.wholesaleAdvantage),a.append("brand",t.brand),a.append("category",t.category),a.append("subcategory",t.subcategory),a.append("status",t.status),a.append("slug",t.slug),t.primaryImage instanceof File&&a.append("primaryImages",t.primaryImage);const r=t.variants.map(s=>({quantityValue:Number(s.quantityValue),quantityUnit:s.quantityUnit,originalPrice:Number(s.originalPrice),discountType:s.discountType||"percent",discountValue:Number(s.discountValue||0),gstRate:Number(s.gstRate||18),stock:Number(s.stock),sku:s.sku,images:s.images||[]}));a.append("variants",JSON.stringify(r)),await h({id:n._id,body:a}).unwrap(),v.success("Product Updated Successfully"),m()}catch(a){v.error(a.message||"Update Failed")}};return x?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-xl w-[800px] p-6 shadow-xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Edit Product"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{name:"productName",value:t.productName,onChange:l,placeholder:"Product Name",className:"border p-2 rounded-lg"}),e.jsx("input",{name:"slug",value:t.slug,onChange:l,placeholder:"Slug",className:"border p-2 rounded-lg"}),e.jsx("input",{name:"brand",value:t.brand,onChange:l,placeholder:"Brand ID",className:"border p-2 rounded-lg"}),e.jsx("input",{name:"category",value:t.categoryname,onChange:l,placeholder:"Category ID",className:"border p-2 rounded-lg"}),e.jsx("input",{name:"subcategory",value:t.subcategoryname,onChange:l,placeholder:"Subcategory ID",className:"border p-2 rounded-lg"}),e.jsx("input",{name:"status",value:t.status,onChange:l,placeholder:"Status",className:"border p-2 rounded-lg"})]}),e.jsx("textarea",{name:"description",value:t.description,onChange:l,placeholder:"Description",className:"w-full border p-2 rounded-lg mt-3"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-3",children:[e.jsx("input",{name:"origin",value:t.origin,onChange:l,placeholder:"Origin",className:"border p-2 rounded"}),e.jsx("input",{name:"shelfLife",value:t.shelfLife,onChange:l,placeholder:"Shelf Life",className:"border p-2 rounded"}),e.jsx("input",{name:"storage",value:t.storage,onChange:l,placeholder:"Storage Info",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-medium",children:"Main Product Image"}),e.jsxs("div",{className:"border-dashed border-2 rounded-lg p-4 text-center mt-2 relative",children:[u?e.jsx("img",{src:u,alt:"Preview",className:"h-32 mx-auto object-contain"}):e.jsx("p",{children:"Click to upload image"}),e.jsx("input",{type:"file",name:"primaryImage",onChange:l,className:"absolute inset-0 opacity-0 cursor-pointer"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Variants"}),t.variants.map((a,r)=>e.jsxs("div",{className:"border p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{value:a.label||"",onChange:s=>i(r,"label",s.target.value),placeholder:"Label",className:"border p-2 rounded"}),e.jsx("input",{type:"number",value:a.quantityValue||"",onChange:s=>i(r,"quantityValue",s.target.value),placeholder:"Quantity",className:"border p-2 rounded"}),e.jsx("input",{value:a.quantityUnit||"",onChange:s=>i(r,"quantityUnit",s.target.value),placeholder:"Unit (kg, ml, etc)",className:"border p-2 rounded"}),e.jsx("input",{type:"number",value:a.originalPrice||"",onChange:s=>i(r,"originalPrice",s.target.value),placeholder:"Original Price",className:"border p-2 rounded"}),e.jsx("input",{type:"number",value:a.discountValue||"",onChange:s=>i(r,"discountValue",s.target.value),placeholder:"Discount",className:"border p-2 rounded"}),e.jsxs("select",{value:a.discountType||"percent",onChange:s=>i(r,s),name:"discountType",className:"border p-2 rounded",children:[e.jsx("option",{value:"percent",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed"})]}),e.jsx("input",{type:"number",value:a.stock||"",onChange:s=>i(r,"stock",s.target.value),placeholder:"Stock",className:"border p-2 rounded"}),e.jsx("input",{value:a.sku||"",onChange:s=>i(r,"sku",s.target.value),placeholder:"SKU",className:"border p-2 rounded"}),e.jsx("input",{type:"number",value:a.gstRate||"",onChange:s=>i(r,"gstRate",s.target.value),placeholder:"GST Rate",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Variant Image"}),e.jsxs("div",{className:"border-dashed border-2 rounded-lg p-3 text-center mt-1 relative",children:[a.preview||a.image?e.jsx("img",{src:a.preview||(typeof a.image=="string"?a.image:""),alt:"Variant Preview",className:"h-24 mx-auto object-contain"}):e.jsx("p",{className:"text-sm",children:"Upload Image"}),e.jsx("input",{type:"file",onChange:s=>b(r,s.target.files[0]),className:"absolute inset-0 opacity-0 cursor-pointer"})]})]}),e.jsx("button",{onClick:()=>j(r),className:"text-red-500 text-sm mt-3",children:"Remove Variant"})]},r)),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-green-500 text-white rounded-lg",children:"+ Add Variant"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:m,className:"px-4 py-2 bg-gray-200 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:f,disabled:g,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg",children:g?"Updating...":"Update"})]})]})}):null}Array.from({length:20});const _=()=>{const{data:x,isLoading:m,isError:n}=k(),h=x?.data||[],[g,{isLoading:t}]=P(),[d,u]=c.useState(!1),[p,l]=c.useState(null),[i,b]=c.useState(""),y=async a=>{if(window.confirm("Are you sure you want to delete this category?"))try{await g(a).unwrap(),toast.success("Category Deleted Successfully")}catch(s){toast.error("Error to delete Category",s)}},j=h.filter(a=>{const r=i.toLowerCase();return a.slug?.toLowerCase().includes(r)||a.price?.toString().includes(r)}),f=()=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-3 bg-white animate-pulse",children:[e.jsx("div",{className:"h-24 bg-gray-200 rounded-lg mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]});return n?e.jsx("p",{children:"No products available"}):m?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Array.from({length:8}).map((a,r)=>e.jsx(f,{},r))}):e.jsxs("div",{className:"p-6 bg-white rounded-xl border border-emerald-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mb-8",children:[e.jsx("div",{className:"w-full lg:w-[40%] md:w-[50%]",children:e.jsxs("div",{className:"flex items-center gap-2 bg-white border-2 border-brand-soft rounded-2xl p-3 focus-within:border-brand-teal transition-all",children:[e.jsx(V,{className:"text-brand-gray",size:20}),e.jsx("input",{className:"w-full bg-transparent border-none focus:ring-0 focus:outline-none text-brand-navy placeholder:text-brand-gray",type:"text",placeholder:"Search By User Name and Phone no",value:i,onChange:a=>b(a.target.value)})]})}),e.jsxs("div",{className:"flex justify-evenly gap-2 items-center",children:[e.jsx("button",{className:"bg-brand-cyan  font-semibold text-brand-navy px-3 py-3 rounded-xl flex justify-center gap-2 items-center",children:e.jsx(U,{size:20})}),e.jsxs("button",{className:"border-brand-cyan border-[1px] font-semibold text-brand-navy px-3 py-3 rounded-2xl flex justify-center gap-2 items-center",children:[e.jsx("p",{children:"Todayâ€™s"})," ",e.jsx(L,{size:20})]}),e.jsxs("button",{className:"bg-brand-navy px-6 py-3 rounded-2xl flex justify-center gap-2 items-center text-white font-bold hover:bg-opacity-90 transition-all",children:[e.jsx(I,{size:20})," Export"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-5",children:j.map(a=>e.jsxs("div",{className:"relative border border-emerald-200 rounded-xl p-3 hover:shadow-md transition",children:[e.jsx("span",{className:`
  absolute top-2 right-2
  h-5 w-5
  bg-green-500
  rounded-full
  flex items-center justify-center
  text-white
  text-xs
  font-bold
`,children:"+"}),e.jsx("div",{className:"flex justify-center mb-3 bg-[#62CDB929]",children:e.jsx("img",{src:a.displayImage,alt:"product",className:"h-24 object-contain"})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-800 leading-tight",children:a.slug}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("p",{className:"text-sm text-gray-500  font-semibold ",children:a.price}),e.jsx("p",{className:"text-sm text-gray-500 ",children:a.originalPrice})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("p",{className:"text-xs text-gray-600",children:["In Stock :",e.jsx("span",{className:"ml-1 text-green-600 font-semibold",children:"100"})]}),e.jsxs("p",{className:"text-xs bg-slate-900 text-white px-2 py-0.5 rounded-md",children:["Qty :",e.jsx("span",{className:"ml-1 font-semibold",children:"100"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-1 p-1.5 rounded-md bg-indigo-50 text-indigo-600 text-xs font-medium",onClick:()=>{l(a),u(!0)},children:[e.jsx(w,{size:12}),"Edit"]}),e.jsx("button",{className:"flex items-center justify-center p-1.5 rounded-md bg-red-50 text-red-600",onClick:()=>y(a._i),children:e.jsx(C,{size:12})})]})]},a._i))}),e.jsx(F,{isOpen:d,onClose:()=>u(!1),productData:p})]})};export{_ as default};
