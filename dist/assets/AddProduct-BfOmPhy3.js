import{r as b,j as e,y as i}from"./index-DwftglYh.js";import{l as R,g as E,j as D,e as B}from"./productsApi--YTSQkNk.js";const l=({label:d,...c})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:d}),e.jsx("input",{...c,className:`w-full mt-1 px-3 py-2 text-sm border border-gray-200 rounded-lg 
      focus:ring-2 focus:ring-[#00E5B0] outline-none`})]}),j=({label:d,...c})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:d}),e.jsx("textarea",{rows:"3",...c,className:`w-full mt-1 px-3 py-2 text-sm border border-gray-200 rounded-lg 
      focus:ring-2 focus:ring-[#00E5B0] outline-none`})]}),f=({label:d,options:c,...h})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:d}),e.jsxs("select",{...h,className:`w-full mt-1 px-3 py-2 text-sm border border-gray-200 rounded-lg 
      focus:ring-2 focus:ring-[#00E5B0] outline-none`,children:[e.jsx("option",{value:"",children:"Select"}),c.map(g=>e.jsx("option",{value:g._id,children:g.name},g._id))]})]});function L(){const[d,{isLoading:c}]=R(),{data:h}=E(),{data:g}=D(),{data:C}=B(),v=h?.data||[],V=g?.data||[],w=C?.data||[],[N,k]=b.useState(null),[r,m]=b.useState({productName:"",subtext:"",description:"",keyFeatures:"",wholesaleAdvantage:"",brand:"",category:"",subcategory:"",status:"active",primaryImages:""}),q=b.useMemo(()=>r.category?v.filter(s=>s.CategoryId===r.category):[],[r.category,v]),[o,y]=b.useState([{quantityValue:"",quantityUnit:"",originalPrice:"",discountType:"percent",discountValue:"",gstRate:"",stock:"",sku:"",images:[],previewImages:[]}]),p=s=>{m({...r,[s.target.name]:s.target.value})},P=s=>{m({...r,category:s.target.value,subcategory:""})},S=s=>{m({...r,subcategory:s.target.value})},u=(s,a)=>{const t=[...o];t[s][a.target.name]=a.target.value,y(t)},F=()=>{y([...o,{quantityValue:"",quantityUnit:"",originalPrice:"",discountType:"percent",discountValue:"",gstRate:"",stock:"",sku:"",images:[],previewImages:[]}])},A=s=>{y(o.filter((a,t)=>t!==s))},I=async s=>{if(s.preventDefault(),!r.productName.trim())return i.error("Product Name is required");if(!r.brand)return i.error("Brand is required");if(!r.category)return i.error("Category is required");if(!r.subcategory)return i.error("Subcategory is required");if(!r.primaryImages)return i.error("Primary Image is required");if(!o.length)return i.error("At least one variant required");for(let a=0;a<o.length;a++){const t=o[a];if(!t.quantityValue||!t.quantityUnit)return i.error(`Variant ${a+1}: Quantity required`);if(!t.originalPrice)return i.error(`Variant ${a+1}: Original Price required`);if(!t.stock)return i.error(`Variant ${a+1}: Stock required`);if(!t.sku)return i.error(`Variant ${a+1}: SKU required`)}try{const a=new FormData;a.append("productName",r.productName.trim()),a.append("subtext",r.subtext.trim()),a.append("description",r.description.trim()),a.append("keyFeatures",r.keyFeatures.trim()),a.append("wholesaleAdvantage",r.wholesaleAdvantage.trim()),a.append("brand",r.brand),a.append("category",r.category),a.append("subcategory",r.subcategory),a.append("status",r.status),a.append("primaryImages",r.primaryImages);const t=o.map(n=>({quantityValue:Number(n.quantityValue),quantityUnit:n.quantityUnit,originalPrice:Number(n.originalPrice),discountType:n.discountType||"percent",discountValue:Number(n.discountValue||0),gstRate:Number(n.gstRate||0),stock:Number(n.stock),sku:n.sku,images:[]}));a.append("variants",JSON.stringify(t)),o.forEach(n=>{n.images.forEach(x=>{a.append("variantImages",x)})}),await d(a).unwrap(),i.success("Product Added Successfully ✅")}catch(a){console.error(a),i.error(a?.data?.message||"Failed to Add Product ❌")}};return e.jsx("div",{className:"bg-[#F8FAFC] py-6 px-4",children:e.jsxs("div",{className:"max-w-5xl mx-auto bg-white rounded-xl shadow-md border",children:[e.jsx("div",{className:"px-5 py-3 border-b bg-[#1E264F] rounded-t-xl",children:e.jsx("h2",{className:"text-white font-semibold text-lg",children:"Add New Product"})}),e.jsxs("form",{onSubmit:I,className:"p-5 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(l,{label:"Product Name",name:"productName",value:r.productName,onChange:p}),e.jsx(l,{label:"Subtext",name:"subtext",value:r.subtext,onChange:p}),e.jsx(f,{label:"Brand",value:r.brand,onChange:s=>m({...r,brand:s.target.value}),options:V}),e.jsx(f,{label:"Category",value:r.category,onChange:P,options:w}),e.jsx(f,{label:"Subcategory",value:r.subcategory,onChange:S,options:q}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Product Image"}),e.jsx("label",{htmlFor:"mainImage",className:`mt-1 flex items-center justify-center border-2 border-dashed 
    rounded-lg p-4 cursor-pointer hover:border-[#00E5B0]`,children:N?e.jsx("img",{src:N,alt:"preview",className:"h-24 object-contain"}):e.jsx("span",{className:"text-xs text-gray-400",children:"Click to Upload"})}),e.jsx("input",{type:"file",id:"mainImage",accept:"image/*",className:"hidden",onChange:s=>{const a=s.target.files[0];a&&(m(t=>({...t,primaryImages:a})),k(URL.createObjectURL(a)))}})]}),e.jsx(j,{label:"Description",name:"description",value:r.description,onChange:p}),e.jsx(j,{label:"Key Features (Comma separated)",name:"keyFeatures",value:r.keyFeatures,onChange:p}),e.jsx(j,{label:"Wholesale Advantage",name:"wholesaleAdvantage",value:r.wholesaleAdvantage,onChange:p})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:"Product Variants"}),o.map((s,a)=>e.jsxs("div",{className:"border p-4 rounded-lg bg-gray-50 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx(l,{label:"Quantity Value",name:"quantityValue",value:s.quantityValue,onChange:t=>u(a,t)}),e.jsx(l,{label:"Quantity Unit",name:"quantityUnit",value:s.quantityUnit,onChange:t=>u(a,t)}),e.jsx(l,{label:"Original Price",name:"originalPrice",value:s.originalPrice,onChange:t=>u(a,t)}),e.jsx(l,{label:"Discount Value",name:"discountValue",value:s.discountValue,onChange:t=>u(a,t)}),e.jsx(l,{label:"GST Rate",name:"gstRate",value:s.gstRate,onChange:t=>u(a,t)}),e.jsx(l,{label:"Stock",name:"stock",value:s.stock,onChange:t=>u(a,t)}),e.jsx(l,{label:"SKU",name:"sku",value:s.sku,onChange:t=>u(a,t)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Variant Images"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:t=>{const n=Array.from(t.target.files),x=[...o];x[a].images=n,x[a].previewImages=n.map(U=>URL.createObjectURL(U)),y(x)},className:"mt-2"}),e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:s.previewImages?.map((t,n)=>e.jsx("img",{src:t,alt:"variant",className:"h-16 rounded border"},n))})]}),o.length>1&&e.jsx("button",{type:"button",onClick:()=>A(a),className:"text-red-500 text-sm",children:"Remove Variant"})]},a)),e.jsx("button",{type:"button",onClick:F,className:"bg-[#1E264F] text-white px-4 py-2 rounded-lg text-sm",children:"+ Add Variant"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:c,className:"bg-[#00E5B0] text-white px-5 py-2 rounded-lg",children:c?"Adding...":"Add Product"})})]})]})})}export{L as default};
